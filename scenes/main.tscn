[gd_scene load_steps=29 format=3 uid="uid://dc4m2o6rx7t1j"]

[ext_resource type="PackedScene" uid="uid://dlss5l7s81x7o" path="res://scenes/player.tscn" id="1_o5qli"]
[ext_resource type="Script" uid="uid://4qwki5hxkwbg" path="res://scripts/main.gd" id="1_tefeu"]
[ext_resource type="MeshLibrary" uid="uid://d080r1hwfqfl8" path="res://scenes/tileset.tres" id="3_sugp2"]
[ext_resource type="PackedScene" uid="uid://byqlpoakon47k" path="res://scenes/candle.tscn" id="4_jyhfs"]
[ext_resource type="Texture2D" uid="uid://cm36lloods2oq" path="res://assets/images/crosshair.png" id="5_tefeu"]
[ext_resource type="Script" uid="uid://c0vp2orewcgg3" path="res://scripts/hud.gd" id="7_tipki"]
[ext_resource type="FontFile" uid="uid://uxw2xkghxi8f" path="res://assets/fonts/Times Regular.ttf" id="7_ya4ey"]
[ext_resource type="Texture2D" uid="uid://ri4rq7u2kwd1" path="res://assets/images/book_background_pixelart.png" id="8_eb6dy"]
[ext_resource type="FontFile" uid="uid://okkkco4bro2x" path="res://assets/fonts/OldLondon.ttf" id="9_a8y0u"]
[ext_resource type="PackedScene" uid="uid://coey4c11c061r" path="res://scenes/coffin.tscn" id="9_choun"]
[ext_resource type="Texture2D" uid="uid://beey7tqrleyh6" path="res://assets/images/arrow.png" id="9_trceg"]
[ext_resource type="PackedScene" uid="uid://bk4ks0dnqy4f7" path="res://scenes/book.tscn" id="10_choun"]
[ext_resource type="AudioStream" uid="uid://dpjwd55b7cqeu" path="res://assets/audio/page_flip.mp3" id="11_jkv2x"]
[ext_resource type="PackedScene" uid="uid://cggrv860g4o7o" path="res://scenes/rat.tscn" id="15_jkv2x"]
[ext_resource type="PackedScene" uid="uid://cuk8hbu0l73pd" path="res://scenes/skull.tscn" id="16_jbj1t"]
[ext_resource type="AudioStream" uid="uid://c6t172r2waf82" path="res://assets/audio/music/8 bit Tavern.mp3" id="16_muem4"]

[sub_resource type="NavigationMesh" id="NavigationMesh_jyhfs"]
vertices = PackedVector3Array(-1.25, 0.5, -15.5, -1.25, 0.5, -14.5, 1.5, 0.5, -14.5, 1.5, 0.5, -15.5, -1.25, -5.5, -13.25, -1.25, -5.5, -8.5, 1.5, -5.5, -8.5, 1.5, -5.5, -13.25, 1.5, 0.5, -7.5, -1.25, 0.5, -7.5, -1.25, 0.5, -5.75, 1.75, 0.5, -5.25, 5.5, 0.5, 5.25, 5.5, 0.5, -5.25, -1.75, 0.5, -5.25, -5.25, 0.5, 5.25, -5.25, 0.5, -5.25)
polygons = [PackedInt32Array(3, 2, 0), PackedInt32Array(0, 2, 1), PackedInt32Array(7, 6, 4), PackedInt32Array(4, 6, 5), PackedInt32Array(9, 8, 10), PackedInt32Array(10, 8, 11), PackedInt32Array(11, 13, 12), PackedInt32Array(10, 11, 14), PackedInt32Array(14, 11, 15), PackedInt32Array(15, 11, 12), PackedInt32Array(15, 16, 14)]
agent_height = 0.5

[sub_resource type="Environment" id="Environment_jyhfs"]
background_energy_multiplier = 0.0

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_o6xl0"]

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_tbgi4"]
bg_color = Color(0.556863, 0, 0.12549, 1)

[sub_resource type="LabelSettings" id="LabelSettings_85g3d"]
font_color = Color(1, 0, 0, 1)

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_tipki"]
bg_color = Color(0, 0.545098, 0.12549, 1)

[sub_resource type="LabelSettings" id="LabelSettings_tipki"]
font_size = 30
font_color = Color(1, 0, 0, 1)

[sub_resource type="LabelSettings" id="LabelSettings_eb6dy"]
font = ExtResource("7_ya4ey")
font_size = 30
font_color = Color(1, 0, 0, 1)

[sub_resource type="LabelSettings" id="LabelSettings_trceg"]
font = ExtResource("7_ya4ey")
font_size = 30
font_color = Color(1, 0, 0, 1)

[sub_resource type="LabelSettings" id="LabelSettings_a8y0u"]
font = ExtResource("9_a8y0u")
font_size = 100
font_color = Color(1, 0, 0, 1)

[sub_resource type="BoxShape3D" id="BoxShape3D_jbj1t"]
size = Vector3(4.34155, 6.0957, 1)

[sub_resource type="BoxShape3D" id="BoxShape3D_muem4"]
size = Vector3(4.05231, 1, 6.16577)

[node name="Main" type="Node3D"]
script = ExtResource("1_tefeu")

[node name="Player" parent="." instance=ExtResource("1_o5qli")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 2.69955)

[node name="NavigationRegion3D" type="NavigationRegion3D" parent="."]
navigation_mesh = SubResource("NavigationMesh_jyhfs")

[node name="GridMap" type="GridMap" parent="NavigationRegion3D"]
transform = Transform3D(2, 0, 0, 0, 2, 0, 0, 0, 2, 0, 0, 0)
mesh_library = ExtResource("3_sugp2")
cell_size = Vector3(1, 0.5, 1)
cell_center_y = false
data = {
"cells": PackedInt32Array(65535, 65535, 1048576, 0, 65535, 1048576, 0, 0, 1048576, 65535, 0, 1048576, 1, 0, 0, 1, 65535, 0, 1, 65534, 0, 0, 65534, 0, 65535, 65534, 0, 65534, 0, 1441792, 65534, 65535, 1441792, 65534, 65534, 1441792, 65534, 1, 1441792, 65535, 1, 1441792, 0, 1, 1441792, 1, 1, 1441792, 65533, 65534, 1048578, 65533, 65535, 1048578, 65533, 0, 1048578, 65533, 1, 1048578, 65534, 2, 655362, 65535, 2, 655362, 0, 2, 655362, 1, 2, 655362, 2, 1, 1441794, 2, 0, 1441794, 2, 65535, 1441794, 2, 65534, 1441794, 1, 65533, 2, 65534, 65533, 2, 65533, 65533, 1048577, 2, 65533, 1, 2, 2, 1441793, 65533, 2, 655361, 0, 65533, 3, 65535, 65533, 1048579, 65535, 65532, 1048578, 0, 65532, 1441794, 65535, 65528, 1048578, 0, 65528, 1441794, 65535, 65531, 1048591, 65535, 65530, 1048591, 65535, 65529, 1048591, 0, 65531, 1441807, 0, 65530, 1441807, 0, 65529, 1441807, -393216, 65531, 1441808, -393216, 65530, 1441808, -393216, 65529, 1441808, -327681, 65529, 1048592, -327681, 65530, 1048592, -327681, 65531, 1048592, -393216, 65532, 17, -327681, 65532, 17, -327681, 65528, 655377, -393216, 65528, 655377)
}
metadata/_editor_floor_ = Vector3(0, -6, 0)

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_jyhfs")

[node name="Entities" type="Node3D" parent="."]

[node name="HUD" type="Control" parent="."]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
size_flags_horizontal = 3
size_flags_vertical = 3
mouse_filter = 2
script = ExtResource("7_tipki")

[node name="Crosshair" type="TextureRect" parent="HUD"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
texture = ExtResource("5_tefeu")
stretch_mode = 3

[node name="BloodBar" type="ProgressBar" parent="HUD"]
layout_mode = 0
offset_left = 47.0
offset_top = 746.0
offset_right = 102.0
offset_bottom = 969.0
theme_override_styles/background = SubResource("StyleBoxFlat_o6xl0")
theme_override_styles/fill = SubResource("StyleBoxFlat_tbgi4")
fill_mode = 3
show_percentage = false

[node name="Label" type="Label" parent="HUD/BloodBar"]
layout_mode = 0
offset_top = 223.0
offset_right = 55.0
offset_bottom = 246.0
text = "blood"
label_settings = SubResource("LabelSettings_85g3d")
horizontal_alignment = 1

[node name="HealthBar" type="ProgressBar" parent="HUD"]
layout_mode = 0
offset_left = 127.0
offset_top = 746.0
offset_right = 182.0
offset_bottom = 969.0
theme_override_styles/background = SubResource("StyleBoxFlat_o6xl0")
theme_override_styles/fill = SubResource("StyleBoxFlat_tipki")
value = 100.0
fill_mode = 3
show_percentage = false

[node name="Label" type="Label" parent="HUD/HealthBar"]
layout_mode = 0
offset_top = 223.0
offset_right = 55.0
offset_bottom = 246.0
text = "health"
label_settings = SubResource("LabelSettings_85g3d")
horizontal_alignment = 1

[node name="AmmoLabel" type="Label" parent="HUD"]
layout_mode = 0
offset_left = 1624.0
offset_top = 936.0
offset_right = 1862.0
offset_bottom = 1018.0
label_settings = SubResource("LabelSettings_tipki")
horizontal_alignment = 2

[node name="InspectLabel" type="Label" parent="HUD"]
layout_mode = 0
offset_left = 2.0
offset_top = 939.0
offset_right = 1917.0
offset_bottom = 988.0
text = "Book
"
label_settings = SubResource("LabelSettings_eb6dy")
horizontal_alignment = 1

[node name="BookBackground" type="ColorRect" parent="HUD"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0, 0, 0, 0.321569)

[node name="BookPixelart" type="TextureRect" parent="HUD/BookBackground"]
modulate = Color(1, 1, 1, 0.356863)
layout_mode = 0
offset_left = 266.0
offset_top = 117.0
offset_right = 1716.0
offset_bottom = 914.0
texture = ExtResource("8_eb6dy")

[node name="PageLeft" type="Label" parent="HUD/BookBackground"]
layout_mode = 0
offset_left = 390.0
offset_top = 221.0
offset_right = 919.0
offset_bottom = 810.0
label_settings = SubResource("LabelSettings_trceg")
autowrap_mode = 2

[node name="PageRight" type="Label" parent="HUD/BookBackground"]
layout_mode = 0
offset_left = 997.0
offset_top = 221.0
offset_right = 1526.0
offset_bottom = 810.0
label_settings = SubResource("LabelSettings_trceg")
autowrap_mode = 2

[node name="Title" type="Label" parent="HUD/BookBackground"]
layout_mode = 0
offset_left = 268.0
offset_top = 62.0
offset_right = 1644.0
offset_bottom = 194.0
text = "Book Title"
label_settings = SubResource("LabelSettings_a8y0u")
horizontal_alignment = 1
vertical_alignment = 1

[node name="PageRightButton" type="Button" parent="HUD/BookBackground"]
layout_mode = 0
offset_left = 1645.0
offset_top = 356.0
offset_right = 1848.0
offset_bottom = 647.0
icon = ExtResource("9_trceg")
flat = true
icon_alignment = 1
expand_icon = true

[node name="PageLeftButton" type="Button" parent="HUD/BookBackground"]
layout_mode = 0
offset_left = 313.0
offset_top = 662.0
offset_right = 516.0
offset_bottom = 953.0
rotation = 3.14159
icon = ExtResource("9_trceg")
flat = true
icon_alignment = 1
expand_icon = true

[node name="PageFlip" type="AudioStreamPlayer" parent="HUD/BookBackground"]
stream = ExtResource("11_jkv2x")

[node name="Candles" type="Node3D" parent="."]

[node name="candle" parent="Candles" instance=ExtResource("4_jyhfs")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 3.056, -0.0336832, 3.90806)

[node name="candle2" parent="Candles" instance=ExtResource("4_jyhfs")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.3314, -0.0336832, -7.2688)

[node name="candle3" parent="Candles" instance=ExtResource("4_jyhfs")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.6944, -0.0336832, -7.2688)

[node name="candle4" parent="Candles" instance=ExtResource("4_jyhfs")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.3314, -0.0336832, -14.8103)

[node name="candle5" parent="Candles" instance=ExtResource("4_jyhfs")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.6944, -0.0336832, -14.8103)

[node name="Pickups" type="Node3D" parent="."]

[node name="Props" type="Node3D" parent="."]

[node name="coffin" parent="Props" instance=ExtResource("9_choun")]
transform = Transform3D(0.835932, 0, -0.548833, 0, 1, 0, 0.548833, 0, 0.835932, 4.40541, 0, 3.76904)

[node name="TheFallOfTheBloodKings" parent="." instance=ExtResource("10_choun")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 2.2412, 2.38419e-07, 3.93146)
contents = "In the dark days of the age of kings, King Garvald ruled the land. Before him was King Titue. And before him, King Polvae. Before him, many more names I do not care to list. This dynasty we call now the \"blood kings\". 

These kings were evil. They were tyrants, hated by all those who worked the fields and those who worked the hammer. The people lived on modest scraps, whilst those of Royal Blood feasted. 

Furthermore, these so called \"Kings\" were in league with the dark forces of this world. They were mere slaves to Vampires. Long ago, a distant ancestor of the Blood Kings made a deal with the Vampires. During the day, he and his men would guard the Vampires in his castles. Then, when night falls the Vampires would descent on the land and elimenate those who dare challenge or question the rule of the Blood Kings.

This went on for hunderds of years. Until the formation of a holy order of Knights: The Order of the Blue Flame. These brave knights stormed the fortress of King Garvald, fought all day, and slew the vile vampires in their crypts while they slept defenseless.

Many years have passed since that day. And now we have no kings.  We have no masters. We have only protectors: those who protect us from the evil of this realm. The vampires have been hunted to the ends of this earth. All the vampire lords and their clans are extinct. The only remenants are those of weak vampiric ancestry. We call them 'Thinbloods'. 

They are of little threat, but are not to be trusted. Perhaps the world is not yet safe. Until then, the Knights of the Blue Flame protect us."
description = "The Fall Of The Blood Kings"

[node name="Book" parent="." instance=ExtResource("10_choun")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.31027, 1.19209e-07, 3.89862)
contents = "Though I have not ever seen or dissected a true Vampire in my lifetime as they are all dead, I have studied the historical accounts thoroughly. Here is a thorough analysis of the nature of Vampires: their appearance, their diet, weaknesses and behaviour.

APPEARANCE

The Vampire is easily distinguishable from those who yet breath air, eat food, and fuck the living. They have pale gray skin, piercing red eyes, and long claws. Their breath and skin emit no heat. They do not age.

THE HUNGER

The vampiric curse is that of hunger. An insatiable hunger for blood. It is known that Vampires can survive off the blood of animals and creatures. Captured vampires have attested to the horrible taste and the lack of sustinence. A vampire is only ever truly satisifed and fully powerfull when full of human blood.

ABILITIES

The vampire has many known abilities. Some theorize that the partciular powers thaat any signle vampire posess various depending on the vampire clan or bloodlines. Whilst other scholars assert the age or training of the vampire is the deciding factor. Vampires have been recorded performing the following abilities: Teleportation, Transmutation, Necromancy, Metamorphosing...

KILLING A VAMPIRE

The Vampire is strong, fast, and resistant to physical damage. But they are not immune. Vampires can be slayn by the sword. However, they possess many weaknesses. The foremost being sunlight and fire. They are also weak so silver."
description = "On the Nature of Vampires"

[node name="skull" parent="." instance=ExtResource("16_jbj1t")]
transform = Transform3D(0.011444, 0.339066, 0.940693, -0.00412461, 0.940762, -0.339041, -0.999926, 0, 0.0121646, 3.41582, 0.0311372, -0.0329552)
timeline_name = "father"

[node name="Rat" parent="." instance=ExtResource("15_jkv2x")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -2.70509, 0.274349, -1.6015)

[node name="Rat2" parent="." instance=ExtResource("15_jkv2x")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -2.9444, 0.274349, 2.8215)

[node name="Rat3" parent="." instance=ExtResource("15_jkv2x")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4.0715, 0.274349, -2.66515)

[node name="GameMusic" type="AudioStreamPlayer" parent="."]
stream = ExtResource("16_muem4")
volume_db = -20.0
autoplay = true

[node name="SafetyWall" type="StaticBody3D" parent="."]

[node name="CollisionShape3D" type="CollisionShape3D" parent="SafetyWall"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.0570068, -3.22456, -14.3921)
shape = SubResource("BoxShape3D_jbj1t")

[node name="DeathArea" type="Area3D" parent="."]

[node name="CollisionShape3D" type="CollisionShape3D" parent="DeathArea"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.0159607, -5.55782, -10.9447)
shape = SubResource("BoxShape3D_muem4")

[node name="skull2" parent="." instance=ExtResource("16_jbj1t")]
transform = Transform3D(-0.702498, 0.238565, 0.670509, -0.00412461, 0.940762, -0.339041, -0.711673, -0.240941, -0.6599, 1.4651, 0.0311372, -4.82626)
timeline_name = "father2"

[connection signal="can_inspect" from="Player" to="HUD" method="_on_player_can_inspect"]
[connection signal="cannot_inspect" from="Player" to="HUD" method="_on_player_cannot_inspect"]
[connection signal="consumed_blood" from="Player" to="HUD" method="_on_player_consumed_blood"]
[connection signal="update_ammo" from="Player" to="HUD" method="_on_player_update_ammo"]
[connection signal="update_health" from="Player" to="HUD" method="_on_player_update_health"]
[connection signal="pressed" from="HUD/BookBackground/PageRightButton" to="HUD" method="_on_page_right_button_pressed"]
[connection signal="pressed" from="HUD/BookBackground/PageLeftButton" to="HUD" method="_on_page_left_button_pressed"]
[connection signal="body_entered" from="DeathArea" to="." method="_on_death_area_body_entered"]
